const RUM_GENERATION="blog-gen-7-highrate",PRODUCTION_DOMAINS=["blog.adobe.com"];export function sampleRUM(e,t={}){try{if(window.hlx=window.hlx||{},!window.hlx.rum){const e="on"===new URLSearchParams(window.location.search).get("rum")?1:10,t=`${(e=>e.split("").reduce(((e,t)=>(e<<5)-e+t.charCodeAt(0)|0),0))(window.location.href)}-${(new Date).getTime()}-${Math.random().toString(16).substr(2,14)}`,o=Math.random(),a=o*e<1;window.hlx.rum={weight:e,id:t,random:o,isSelected:a}}const{random:o,weight:a,id:n}=window.hlx.rum;if(o&&o*a<1){const o=()=>{const o=JSON.stringify({weight:a,id:n,referer:window.location.href,generation:RUM_GENERATION,checkpoint:e,...t}),r=`https://rum.hlx.page/.rum/${a}`;navigator.sendBeacon(r,o)};o(),"cwv"===e&&import("./web-vitals-module-2-1-2.js").then((e=>{const a=e=>{t.cwv={},t.cwv[e.name]=e.value,o()};e.getCLS(a),e.getFID(a),e.getLCP(a)}))}}catch(e){}}sampleRUM.mediaobserver=window.IntersectionObserver?new IntersectionObserver((e=>{e.filter((e=>e.isIntersecting)).forEach((e=>{sampleRUM.mediaobserver.unobserve(e.target);const t=sampleRUM.targetselector(e.target),o=sampleRUM.sourceselector(e.target);sampleRUM("viewmedia",{target:t,source:o})}))}),{threshold:.25}):{observe:()=>{}},sampleRUM.blockobserver=window.IntersectionObserver?new IntersectionObserver((e=>{e.filter((e=>e.isIntersecting)).forEach((e=>{sampleRUM.blockobserver.unobserve(e.target);const t=sampleRUM.targetselector(e.target),o=sampleRUM.sourceselector(e.target);sampleRUM("viewblock",{target:t,source:o})}))}),{threshold:.25}):{observe:()=>{}},sampleRUM.observe=e=>{e.forEach((e=>{"img"===e.tagName.toLowerCase()||"video"===e.tagName.toLowerCase()||"audio"===e.tagName.toLowerCase()||"iframe"===e.tagName.toLowerCase()?sampleRUM.mediaobserver.observe(e):sampleRUM.blockobserver.observe(e)}))},sampleRUM.sourceselector=e=>{if(e!==document.body&&e!==document.documentElement&&e)return e.id?`#${e.id}`:e.getAttribute("data-block-name")?`.${e.getAttribute("data-block-name")}`:sampleRUM.sourceselector(e.parentElement)},sampleRUM.targetselector=e=>{let t=e.getAttribute("href")||e.currentSrc||e.getAttribute("src");return t&&t.startsWith("https://")&&(t=new URL(t,window.location).href),t},sampleRUM("top"),window.addEventListener("load",(()=>sampleRUM("load"))),document.addEventListener("click",(e=>{sampleRUM("click",{target:sampleRUM.targetselector(e.target),source:sampleRUM.sourceselector(e.target)})}));const olderror=window.onerror;window.onerror=(e,t,o)=>{if(sampleRUM("error",{source:t,target:o}),"function"!=typeof olderror)throw new Error(e);olderror(e,t,o)};export function loadCSS(e,t){if(document.querySelector(`head > link[href="${e}"]`))"function"==typeof t&&t("noop");else{const o=document.createElement("link");o.setAttribute("rel","stylesheet"),o.setAttribute("href",e),"function"==typeof t&&(o.onload=e=>t(e.type),o.onerror=e=>t(e.type)),document.head.appendChild(o)}}export function makeLinksRelative(e){e.querySelectorAll("a").forEach((e=>{const t=["hlx3.page","hlx.page","hlx.live",...PRODUCTION_DOMAINS];if(e.href)try{const o=new URL(e.href);t.some((e=>o.hostname.includes(e)))&&(e.href=`${o.pathname.replace(/\.html$/,"")}${o.search}${o.hash}`)}catch(e){console.log(e)}}))}const LANG={EN:"en",DE:"de",FR:"fr",KO:"ko",ES:"es",IT:"it",JP:"jp",BR:"br"},LANG_LOCALE={en:"en_US",de:"de_DE",fr:"fr_FR",ko:"ko_KR",es:"es_ES",it:"it_IT",jp:"ja_JP",br:"pt_BR"};let language,taxonomy;export function getLanguage(){if(language)return language;language=LANG.EN;const e=window.location.pathname.split("/");if(e&&e.length>0)for(const[,t]of Object.entries(LANG))if(t===e[1]){language=t;break}return language}export function getLocale(){const e=getLanguage();return LANG_LOCALE[e]}function getDateLocale(){let e=getLanguage();e===LANG.EN&&(e="en-US"),e===LANG.BR&&(e="pt-BR"),e===LANG.JP&&(e="ja-JP");const t=window.location.pathname.split("/").pop().split(".")[0];return"uk"!==t&&"apac"!==t||(e="en-UK"),e}export function getRootPath(){return`/${getLanguage()}`}export function getMetadata(e,t=!1){const o=e&&e.includes(":")?"property":"name",a=[...document.head.querySelectorAll(`meta[${o}="${e}"]`)].map((e=>e.content));return t?a:a.join(", ")}export function getHelixEnv(){let e=sessionStorage.getItem("helix-env");e||(e="prod");const t={dev:{ims:"stg1",subdomain:"dev02.",adobeIO:"cc-collab-stage.adobe.io",adminconsole:"stage.adminconsole.adobe.com",account:"stage.account.adobe.com",target:!1},stage:{ims:"stg1",subdomain:"stage.",adobeIO:"cc-collab-stage.adobe.io",adminconsole:"stage.adminconsole.adobe.com",account:"stage.account.adobe.com",target:!1},prod:{ims:"prod",subdomain:"",adobeIO:"cc-collab.adobe.io",adminconsole:"adminconsole.adobe.com",account:"account.adobe.com",target:!0}}[e],o=sessionStorage.getItem("helix-env-overrides");if(o){const e=JSON.parse(o),a=Object.keys(e);t.overrides=a,a.forEach((o=>{t[o]=e[o]}))}return t&&(t.name=e),t}export function debug(e,...t){const{hostname:o}=window.location;"prod"===getHelixEnv().name&&"localhost"!==o||console.log(e,...t)}async function getMetadataJson(e){let t;try{t=await fetch(`${e.split(".")[0]}?noredirect`)}catch{debug(`Could not retrieve metadata for ${e}`)}if(t&&t.ok){const e=(await t.text()).split("<head>")[1].split("</head>")[0],o=document.createElement("head");o.innerHTML=e;const a=o.querySelectorAll(":scope > meta"),n={};return a.forEach((e=>{const t=e.getAttribute("name")||e.getAttribute("property"),o=e.getAttribute("content");n[t]?n[t]+=`, ${o}`:n[t]=o})),n}return null}function computeTaxonomyFromTopics(e,t){const o=e?.length>0?e[0]:"news";if(taxonomy){const a=[],n=[];return e.forEach((e=>{const o=taxonomy.get(e);if(o){if(!a.includes(e)&&!o.skipMeta){a.push(e),o.isUFT&&n.push(e);const t=taxonomy.getParents(e);t&&t.forEach((e=>{const t=taxonomy.get(e);a.includes(e)||(a.push(e),t.isUFT&&n.push(e))}))}}else debug(`Unknown topic in tags list: ${e} ${t?`on page ${t}`:"(current page)"}`)})),{category:o,topics:e,visibleTopics:n,allTopics:a}}return{category:o,topics:e}}async function loadTaxonomy(){const e=await import("./taxonomy.js");if(taxonomy=await e.default(getLanguage()),taxonomy){document.querySelectorAll("[data-topic-link]").forEach((e=>{const t=e.dataset.topicLink,o=taxonomy.get(t);o?e.href=o.link:(debug(`Trying to get a link for an unknown topic: ${t} (current page)`),e.href="#"),delete e.dataset.topicLink}));const e=getMetadata("article:tag",!0);(computeTaxonomyFromTopics(e).allTopics||[]).forEach((t=>{if(!e.includes(t)){const e=document.createElement("meta");e.setAttribute("property","article:tag"),e.setAttribute("content",t),document.head.append(e)}})),e.forEach((e=>{const t=taxonomy.get(e);if(t&&t.skipMeta){const t=document.querySelector(`[property="article:tag"][content="${e}"]`);t&&t.remove();const o=document.createElement("meta");o.setAttribute("name",e),o.setAttribute("content","true"),document.head.append(o)}}))}}export function getTaxonomy(){return taxonomy}export function getLinkForTopic(e,t){let o;if(taxonomy){const a=taxonomy.get(e);a?o=a.link:(debug(`Trying to get a link for an unknown topic: ${e} ${t?`on page ${t}`:"(current page)"}`),o="#")}return`<a href="${o||""}" ${o?"":`data-topic-link="${e}"`}>${{"Transformation digitale":"Transformation num√©rique"}[e]||e}</a>`}function loadArticleTaxonomy(e){if(!e.allTopics){const{tags:t,path:o}=e;if(t){const a=t.replace(/[["\]]/gm,"").split(",").map((e=>e.trim())).filter((e=>e&&""!==e)),n=computeTaxonomyFromTopics(a,o);e.category=n.category,e.topics=a,e.visibleTopics=n.allVisibleTopics,e.allTopics=n.allTopics}else e.category="News",e.topics=[],e.visibleTopics=[],e.allTopics=[]}}export function getArticleTaxonomy(e){e.allTopics||loadArticleTaxonomy(e);const{category:t,topics:o,visibleTopics:a,allTopics:n}=e;return{category:t,topics:o,visibleTopics:a,allTopics:n}}export function addPublishDependencies(e){const t=Array.isArray(e)?e:[e];window.hlx=window.hlx||{},window.hlx.dependencies&&Array.isArray(window.hlx.dependencies)?window.hlx.dependencies=window.hlx.dependencies.concat(t):window.hlx.dependencies=t}export function toClassName(e){return e&&"string"==typeof e?e.toLowerCase().replace(/[^0-9a-z]/gi,"-"):""}function wrapSections(e){e.forEach((e=>{if(!e.id){const t=document.createElement("div");t.className="section-wrapper",e.parentNode.appendChild(t),t.appendChild(e)}}))}export function decorateBlock(e){const t=Array.from(e.classList.values())[0];if(!t)return;const o=e.closest(".section-wrapper");o&&o.classList.add(`${t}-container`.replace(/--/g,"-"));const a=e=>e.replace(/(^\s*-)|(-\s*$)/g,""),n=t.split("--"),r=a(n.shift()),i=n.map((e=>a(e)));e.classList.add(r),e.classList.add(...i),e.classList.add("block"),e.setAttribute("data-block-name",r),e.setAttribute("data-block-status","initialized");e.parentElement.classList.add(`${r}-wrapper`)}function buildBlock(e,t){const o=Array.isArray(t)?t:[[t]],a=document.createElement("div");return a.classList.add(e),o.forEach((e=>{const t=document.createElement("div");e.forEach((e=>{const o=document.createElement("div");(e.elems?e.elems:[e]).forEach((e=>{e&&("string"==typeof e?o.innerHTML+=e:o.appendChild(e))})),t.appendChild(o)})),a.appendChild(t)})),a}function removeStylingFromImages(e){[...e.querySelectorAll("strong picture"),...e.querySelectorAll("em picture")].forEach((e=>{const t=e.closest("p");t.prepend(e),t.lastChild.remove()}))}function getImageCaption(e){const t=e.parentNode.nextElementSibling;return t&&"EM"===t.firstChild.nodeName?t:void 0}function buildImageBlocks(e){let t;[...e.querySelectorAll(":scope > div > p > picture")].forEach((e=>{const o=e.parentNode,a=buildBlock("images",{elems:[e.cloneNode(!0),getImageCaption(e)]});o.parentNode?(o.replaceWith(a),t=a):t.firstChild.append(a.firstChild.firstChild)}))}function buildArticleHeader(e){const t=document.createElement("div"),o=e.querySelector("h1"),a=e.querySelector("picture"),n=getMetadata("article:tag",!0),r=n.length>0?n[0]:"",i=getMetadata("author"),c=getMetadata("author-url")||`${getRootPath()}/authors/${toClassName(i)}`,l=getMetadata("publication-date"),s=buildBlock("article-header",[[`<p>${getLinkForTopic(r)}</p>`],[o],[`<p><a href="${c}">${i}</a></p>\n      <p>${l}</p>`],[{elems:[a.closest("p"),getImageCaption(a)]}]]);t.append(s),e.prepend(t)}function buildTagHeader(e){const t=e.querySelector("div"),o=buildBlock("tag-header",[[e.querySelector("h1, h2")],[{elems:[e.querySelector("picture").closest("p")]}]]);t.prepend(o)}function buildAuthorHeader(e){const t=e.querySelector("div"),o=e.querySelector("h1, h2"),a=o.nextElementSibling,n=e.querySelector("picture"),r=[[o]];n&&r.push([{elems:[n.closest("p")]}]),a&&"P"===a.nodeName&&r.push([a]);const i=buildBlock("author-header",r);t.prepend(i)}function buildSocialLinks(e){const t=[...e.querySelectorAll("p")].find((e=>"Social:"===e.textContent.trim()));if(t&&t.nextElementSibling===t.parentNode.querySelector("ul")){const e=t.nextElementSibling.outerHTML;t.nextElementSibling.remove(),t.replaceWith(buildBlock("social-links",[[e]]))}}function buildNewsletterModal(e){const t=document.createElement("div"),o=buildBlock("newsletter-modal",[]);t.append(o),e.append(t)}function buildArticleFeed(e,t){const o=document.createElement("div"),a=buildBlock("article-feed",[[t,e.querySelector("h1, h2").textContent.trim()]]);o.append(a),e.append(o)}function buildTagsBlock(e){const t=getMetadata("article:tag",!0);if(taxonomy&&t.length>0){const o=buildBlock("tags",[[`<p>${computeTaxonomyFromTopics(t).visibleTopics.map((e=>getLinkForTopic(e))).join("")}</p>`]]),a=e.querySelector(".recommended-articles-container");a?a.previousElementSibling.firstChild.append(o):e.lastElementChild.firstChild&&e.lastElementChild.firstChild.append(o),decorateBlock(o)}}function decorateBlocks(e){e.querySelectorAll("div.section-wrapper > div > div").forEach((e=>decorateBlock(e)))}function addArticleToHistory(){const e=`blog-${getLocale()}-history`,t=JSON.parse(localStorage.getItem(e)||"[]");t.unshift({path:window.location.pathname,tags:getMetadata("article:tag")}),localStorage.setItem(e,JSON.stringify(t.slice(0,5)))}function buildAutoBlocks(e){removeStylingFromImages(e);try{getMetadata("publication-date")&&!e.querySelector(".article-header")&&(buildArticleHeader(e),addArticleToHistory()),window.location.pathname.includes("/topics/")&&(buildTagHeader(e),e.querySelector(".article-feed")||buildArticleFeed(e,"tags")),window.location.pathname.includes("/authors/")&&(buildAuthorHeader(e),buildSocialLinks(e),document.querySelector(".article-feed")||buildArticleFeed(e,"author")),buildImageBlocks(e),buildNewsletterModal(e)}catch(e){console.error("Auto Blocking failed",e)}}function unwrapBlock(e){const t=e.parentNode,o=[...t.children],a=document.createElement("div"),n=document.createElement("div"),r=t.nextSibling;let i;t.parentNode.insertBefore(a,r),t.parentNode.insertBefore(n,r),o.forEach((t=>{t===e&&(i=a),i&&(i.appendChild(t),i=n)})),t.hasChildNodes()||t.remove(),a.hasChildNodes()||a.remove(),n.hasChildNodes()||n.remove()}function splitSections(){document.querySelectorAll("main > div > div").forEach((e=>{["article-header","article-feed","recommended-articles","video","carousel"].includes(e.className)&&unwrapBlock(e)}))}function removeEmptySections(){document.querySelectorAll("main > div:empty").forEach((e=>{e.remove()}))}export function buildCaption(e){const t=document.createElement("figcaption");return e.classList.add("caption"),t.append(e),t}export function buildFigure(e){const t=document.createElement("figure");return t.classList.add("figure"),e.childNodes.forEach((e=>{const o=e.cloneNode(!0);if("PICTURE"===o.nodeName||"VIDEO"===o.nodeName||"A"===o.nodeName)t.prepend(o);else{const e=o.querySelector("picture");e&&t.prepend(e);const a=o.querySelector("video");a&&t.prepend(a);const n=o.querySelector("em");if(n){const e=buildCaption(n);t.append(e)}const r=o.querySelector("a");if(r){const e=t.querySelector("picture")||t.querySelector("video");e&&(r.textContent="",r.append(e)),t.prepend(r)}}})),t}export async function loadBlock(e,t=!1){if("loading"!==e.getAttribute("data-block-status")&&"loaded"!==e.getAttribute("data-block-status")){e.setAttribute("data-block-status","loading");const o=e.getAttribute("data-block-name"),{list:a}=window.milo?.libs?.blocks,n=!(!a||!a.includes(o)),r=n?window.milo.libs.base:"";try{const a=new Promise((e=>{loadCSS(`${r}/blocks/${o}/${o}.css`,e),n&&loadCSS(`${r}/styles/variables.css`,e)})),i=new Promise((a=>{(async()=>{try{const a=await import(`${r}/blocks/${o}/${o}.js`);a.default&&await a.default(e,o,document,t)}catch(e){debug(`failed to load module for ${o}`,e)}a()})()}));await Promise.all([a,i])}catch(e){debug(`failed to load module for ${o}`,e)}e.setAttribute("data-block-status","loaded")}}function loadBlocks(e){return[...e.querySelectorAll("div.section-wrapper > div > .block")].map((e=>loadBlock(e)))}export function readBlockConfig(e){const t={};return e.querySelectorAll(":scope>div").forEach((e=>{if(e.children){const o=[...e.children];if(o[1]){const a=o[1],n=toClassName(o[0].textContent);let r="";if(a.querySelector("a")){const e=[...a.querySelectorAll("a")];r=1===e.length?e[0].href:e.map((e=>e.href))}else if(a.querySelector("p")){const e=[...a.querySelectorAll("p")];r=1===e.length?e[0].textContent:e.map((e=>e.textContent))}else r=e.children[1].textContent;t[n]=r}}})),t}export function normalizeHeadings(e,t){const o=t.map((e=>e.toLowerCase()));e.querySelectorAll("h1, h2, h3, h4, h5, h6").forEach((e=>{const t=e.tagName.toLowerCase();if(-1===o.indexOf(t)){let a=parseInt(t.charAt(1),10)-1;for(;-1===o.indexOf(`h${a}`)&&a>0;)a-=1;if(0===a)for(;-1===o.indexOf(`h${a}`)&&a<7;)a+=1;7!==a&&(e.outerHTML=`<h${a}>${e.textContent}</h${a}>`)}}))}export function createOptimizedPicture(e,t="",o=!1,a=[{media:"(min-width: 400px)",width:"2000"},{width:"750"}]){const n=new URL(e,window.location.href),r=document.createElement("picture"),{pathname:i}=n,c=i.substring(i.lastIndexOf(".")+1);return a.forEach((e=>{const t=document.createElement("source");e.media&&t.setAttribute("media",e.media),t.setAttribute("type","image/webp"),t.setAttribute("srcset",`${i}?width=${e.width}&format=webply&optimize=medium`),r.appendChild(t)})),a.forEach(((e,n)=>{if(n<a.length-1){const t=document.createElement("source");e.media&&t.setAttribute("media",e.media),t.setAttribute("srcset",`${i}?width=${e.width}&format=${c}&optimize=medium`),r.appendChild(t)}else{const a=document.createElement("img");a.setAttribute("src",`${i}?width=${e.width}&format=${c}&optimize=medium`),a.setAttribute("loading",o?"eager":"lazy"),a.setAttribute("alt",t),r.appendChild(a)}})),r}export function formatLocalCardDate(e){let t=e;t=e.includes("-")?e.replace(/-/g,"/"):new Date(Math.round(86400*(e-25569)*1e3));const o=getDateLocale();let a=new Date(t).toLocaleDateString(o,{day:"2-digit",month:"2-digit",year:"numeric",timeZone:"UTC"});return"en-US"===o&&(a=a.replace(/\//g,"-")),a}export function buildArticleCard(e,t="article",o=!1){const{title:a,description:n,image:r,imageAlt:i,date:c}=e,l=e.path.split(".")[0],s=createOptimizedPicture(r,i||a,o,[{width:"750"}]).outerHTML,d=document.createElement("a");d.className=`${t}-card`,d.href=l;const u=getLinkForTopic(getArticleTaxonomy(e).category,l);return d.innerHTML=`<div class="${t}-card-image">\n      ${s}\n    </div>\n    <div class="${t}-card-body">\n      <p class="${t}-card-category">\n        ${u}\n      </p>\n      <h3>${a}</h3>\n      <p class="${t}-card-description">${n}</p>\n      <p class="${t}-card-date">${formatLocalCardDate(c)}\n    </div>`,d}function decoratePictures(e){e.querySelectorAll('img[src*="/media_"]').forEach(((e,t)=>{const o=createOptimizedPicture(e.src,e.alt,!t),a=e.closest("picture");a&&a.parentElement.replaceChild(o,a)}))}export function decorateMain(e){decoratePictures(e),makeLinksRelative(e),buildAutoBlocks(e),splitSections(),removeEmptySections(),wrapSections(e.querySelectorAll(":scope > div")),decorateBlocks(e),sampleRUM.observe(e.querySelectorAll("div[data-block-name]")),window.setTimeout((()=>sampleRUM.observe(e.querySelectorAll("picture > img"))),1e3)}export function addFavIcon(e){const t=document.createElement("link");t.rel="icon",t.type="image/svg+xml",t.href=e;const o=document.querySelector('head link[rel="icon"]');o?o.parentElement.replaceChild(t,o):document.getElementsByTagName("head")[0].appendChild(t)}export async function fetchBlogArticleIndex(){if(window.blogIndex=window.blogIndex||{data:[],byPath:{},offset:0,complete:!1},window.blogIndex.complete)return window.blogIndex;const e=window.blogIndex,t=await fetch(`${getRootPath()}/query-index.json?limit=500&offset=${e.offset}`),o=await t.json(),a=o.limit+o.offset===o.total;return o.data.forEach((t=>{e.data.push(t),e.byPath[t.path.split(".")[0]]=t})),e.complete=a,e.offset=o.offset+500,e}export async function getBlogArticle(e){const t=await getMetadataJson(`${e}.metadata.json`);if(t){let o=t["og:title"].trim();["|Adobe","| Adobe","| Adobe Blog","|Adobe Blog"].forEach((e=>{o.endsWith(e)&&(o=o.substr(0,o.length-e.length))}));const a={description:t.description,title:o,author:t.author,image:t["og:image"],imageAlt:t["og:image:alt"],date:t["publication-date"],path:e,tags:t["article:tag"]};return loadArticleTaxonomy(a),a}return null}export async function fetchPlaceholders(){if(!window.placeholders){const e=await fetch(`${getRootPath()}/placeholders.json`),t=await e.json();window.placeholders={},t.data.forEach((e=>{window.placeholders[e.Key]=e.Text}))}return window.placeholders}export function loadScript(e,t,o){const a=document.querySelector("head"),n=document.createElement("script");return n.setAttribute("src",e),o&&n.setAttribute("type",o),a.append(n),n.onload=t,n}export async function loadLibs(){if(window.milo=window.milo||{},!window.milo.libs){let e=`https://${PRODUCTION_DOMAINS[0]}`;if(!(window.location.hostname===PRODUCTION_DOMAINS[0])){const t=new URLSearchParams(window.location.search).get("milolibs")||"main";e="local"===t?"http://localhost:6456":`https://${t}.milo.pink`}window.milo.libs={base:`${e}/libs`};try{const{default:e}=await import(`${window.milo.libs.base}/blocks/list.js`);window.milo.libs.blocks={list:e}}catch(e){window.milo.libs.blocks={},console.log("Couldn't load libs list")}}}function loadPrivacy(){window.fedsConfig={privacy:{otDomainId:function(){const e={"adobe.com":"7a5eb705-95ed-4cc4-a11d-0cc5760e93db","hlx.page":"3a6a37fe-9e07-4aa9-8640-8f358a623271","adobeaemcloud.com":"70cd62b6-0fe3-4e20-8788-ef0435b8cdb1"};return`${e[Object.keys(e).find((e=>window.location.host.indexOf(e)>-1))]||e[Object.keys(e)[0]]}`}(),footerLinkSelector:'[href="https://www.adobe.com/#openPrivacy"]'}};loadScript(`https://www.${getHelixEnv().subdomain}adobe.com/etc.clientlibs/globalnav/clientlibs/base/privacy-standalone.js`)}async function loadEager(){const e=document.querySelector("main");if(e){await loadLibs(),decorateMain(e);const t=["featured-article","article-header"],o=document.querySelector(".block");o&&t.includes(o.getAttribute("data-block-name"))&&await loadBlock(o,!0),document.querySelector("body").classList.add("appear");const a=document.querySelector("main img");await new Promise((e=>{a&&!a.complete?(a.addEventListener("load",(()=>e())),a.addEventListener("error",(()=>e()))):e()})),loadPrivacy()}document.querySelector("helix-sidekick")?import("../tools/sidekick/plugins.js"):document.addEventListener("helix-sidekick-ready",(()=>{import("../tools/sidekick/plugins.js")}),{once:!0})}async function loadLazy(){const e=document.querySelector("main");sampleRUM("lcp");const t=document.querySelector("header"),o=getMetadata("gnav")||`${getRootPath()}/gnav`;t.setAttribute("data-block-name","gnav"),t.setAttribute("data-gnav-source",o),loadBlock(t);const a=document.querySelector("footer");if(a.setAttribute("data-block-name","footer"),a.setAttribute("data-footer-source",`${getRootPath()}/footer`),loadBlock(a),await loadTaxonomy(),buildTagsBlock(e),loadBlocks(e),loadCSS("/styles/lazy-styles.css"),addFavIcon("/styles/favicon.svg"),window.location.pathname.endsWith("/")){const e=500;let t=0;for(;t<10*e;)addPublishDependencies(`/${getLanguage()}/query-index.json?limit=${e}&offset=${t}`),t+=e}}function loadDelayed(){const e="/scripts/delayed.js",t=new URLSearchParams(window.location.search);if("off"!==t.get("delayed")&&!document.querySelector(`head script[src="${e}"]`)){let o=3500;const a=t.get("delay");a&&(o=+a),setTimeout((()=>{loadScript(e,null,"module")}),o)}}async function decoratePage(){await loadEager(),loadLazy(),loadDelayed()}function setHelixEnv(e,t){e?(sessionStorage.setItem("helix-env",e),t?sessionStorage.setItem("helix-env-overrides",JSON.stringify(t)):sessionStorage.removeItem("helix-env-overrides")):(sessionStorage.removeItem("helix-env"),sessionStorage.removeItem("helix-env-overrides"))}function displayEnv(){try{const e=new URLSearchParams(window.location.search);if(e.has("helix-env")){setHelixEnv(e.get("helix-env"))}if(document.referrer){const e=new URL(document.referrer);window.location.hostname!==e.hostname&&debug(`external referrer detected: ${document.referrer}`)}}catch(e){debug(`display env failed: ${e.message}`)}}decoratePage(window),displayEnv();export function stamp(e){window.name.includes("performance")&&debug(`${new Date-performance.timing.navigationStart}:${e}`)}function registerPerformanceLogger(){try{new PerformanceObserver((e=>{const t=e.getEntries();stamp(JSON.stringify(t)),debug(t[0].element)})).observe({type:"largest-contentful-paint",buffered:!0});new PerformanceObserver((e=>{const t=e.getEntries();stamp(JSON.stringify(t)),debug(t[0].sources[0].node)})).observe({type:"layout-shift",buffered:!0});new PerformanceObserver((e=>{e.getEntries().forEach((e=>{stamp(`resource loaded: ${e.name} - [${Math.round(e.startTime+e.duration)}]`)}))})).observe({type:"resource",buffered:!0})}catch(e){}}stamp("start"),window.name.includes("performance")&&registerPerformanceLogger();
